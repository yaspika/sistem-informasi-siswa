<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistem Informasi Siswa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
      import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyCzuHPTqPQt5a14G_tia1dx-wSFK8CP8Nw",
        authDomain: "sistem-informasi-siswa-41025.firebaseapp.com",
        projectId: "sistem-informasi-siswa-41025",
        storageBucket: "sistem-informasi-siswa-41025.firebasestorage.app",
        messagingSenderId: "566617915457",
        appId: "1:566617915457:web:da339cb25463512b8586c0"
      };

      const app = initializeApp(firebaseConfig);
      window.db = getFirestore(app);
      window.firebaseFns = { collection, addDoc, getDocs };
    </script>
  </head>
  <body class="bg-gray-100 text-gray-900">
    <div id="root"></div>
    <script type="text/babel">
      const { useState, useEffect } = React;

      function App() {
        const [tab, setTab] = useState("siswa");
        const [data, setData] = useState([]);
        const [input, setInput] = useState({ nama: "", nis: "", kelas: "", jenis_kelamin: "" });

        const handleChange = (e) => {
          const { name, value } = e.target;
          setInput((prev) => ({ ...prev, [name]: value }));
        };

        const handleSubmit = async () => {
          const { collection, addDoc } = window.firebaseFns;
          if (input.nama && input.nis) {
            await addDoc(collection(window.db, "siswa"), input);
            setInput({ nama: "", nis: "", kelas: "", jenis_kelamin: "" });
            loadData();
          }
        };

        const loadData = async () => {
          const { collection, getDocs } = window.firebaseFns;
          const snapshot = await getDocs(collection(window.db, "siswa"));
          const items = snapshot.docs.map(doc => doc.data());
          setData(items);
        };

        useEffect(() => {
          loadData();
        }, []);
        const tabs = [
          { id: "siswa", label: "Data Siswa" },
          { id: "kehadiran", label: "Kehadiran" },
          { id: "kejadian", label: "Kejadian" },
          { id: "rekap", label: "Rekap" },
        ];

        return (
          <div className="max-w-4xl mx-auto p-4">
            <h1 className="text-2xl font-bold text-center mb-4">Sistem Informasi Siswa</h1>
            <div className="flex space-x-2 mb-4 justify-center">
              {tabs.map((t) => (
                <button
                  key={t.id}
                  className={`px-4 py-2 rounded ${tab === t.id ? "bg-blue-600 text-white" : "bg-white border"}`}
                  onClick={() => setTab(t.id)}
                >
                  {t.label}
                </button>
              ))}
            </div>

            {tab === "siswa" && (
              <div className="bg-white p-4 rounded shadow">
                <h2 className="text-lg font-semibold mb-4">Tambah Data Siswa</h2>
                <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                  <input name="nis" value={input.nis} onChange={handleChange} placeholder="NIS" className="p-2 border rounded w-full" />
                  <input name="nama" value={input.nama} onChange={handleChange} placeholder="Nama" className="p-2 border rounded w-full" />
                  <input name="kelas" value={input.kelas} onChange={handleChange} placeholder="Kelas" className="p-2 border rounded w-full" />
                  <select name="jenis_kelamin" value={input.jenis_kelamin} onChange={handleChange} className="p-2 border rounded w-full">
                    <option value="">Pilih Jenis Kelamin</option>
                    <option value="L">Laki-laki</option>
                    <option value="P">Perempuan</option>
                  </select>
                </div>
                <button onClick={handleSubmit} className="bg-blue-600 text-white px-4 py-2 rounded">Simpan</button>

                <div className="mt-6">
                  <h3 className="text-md font-bold mb-2">Daftar Siswa</h3>
                  <table className="w-full text-sm">
                    <thead>
                      <tr className="border-b bg-gray-100 text-left">
                        <th className="p-2">NIS</th>
                        <th className="p-2">Nama</th>
                        <th className="p-2">Kelas</th>
                        <th className="p-2">JK</th>
                      </tr>
                    </thead>
                    <tbody>
                      {data.map((s, i) => (
                        <tr key={i} className="border-b hover:bg-gray-50">
                          <td className="p-2">{s.nis}</td>
                          <td className="p-2">{s.nama}</td>
                          <td className="p-2">{s.kelas}</td>
                          <td className="p-2">{s.jenis_kelamin}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>
              </div>
            )}

            {tab === "kehadiran" && (
              <div className="bg-white p-4 rounded shadow">
                <h2 className="text-lg font-semibold mb-2">Kehadiran</h2>
                <p className="text-sm text-gray-600">(fitur dalam pengembangan)</p>
              </div>
            )}

            {tab === "kejadian" && (
              <div className="bg-white p-4 rounded shadow">
                <h2 className="text-lg font-semibold mb-2">Kejadian</h2>
                <p className="text-sm text-gray-600">(fitur dalam pengembangan)</p>
              </div>
            )}

            {tab === "rekap" && (
              <div className="bg-white p-4 rounded shadow">
                <h2 className="text-lg font-semibold mb-2">Rekap</h2>
                <p className="text-sm text-gray-600">(fitur dalam pengembangan)</p>
              </div>
            )}
          </div>
        );
      }}

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
